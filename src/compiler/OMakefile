OCAMLINCLUDES += ../runtime
OCAML_LIBS += ../runtime/libcapnp

COMP_MODULES =            \
  c2b2b                   \
  defaults                \
  genCommon               \
  genModules              \
  genSignatures           \
  generate                \
  main                    \
  pluginSchema            \
  topsort


PROGRAM = capnpc-ocaml

OCamlProgram($(PROGRAM), $(COMP_MODULES))

.DEFAULT: $(PROGRAM)$(EXE)

.PHONY: compiler-clean compiler-distclean compiler-install compiler-uninstall

compiler-clean:
	rm -f $(PROGRAM)$(EXE) $(PROGRAM).opt $(PROGRAM).byte \
	    *.cmi *.cmo *.cmx *.cma *.cmxa *.cmxs *.a *.o

compiler-distclean: compiler-clean
	rm -f *.omc

compiler-install: $(PROGRAM)$(EXE)
	install -d $(DESTDIR)$(PREFIX)/bin
	install $(PROGRAM)$(EXE) $(DESTDIR)$(PREFIX)/bin

compiler-uninstall:
	rm -f $(DESTDIR)$(PREFIX)/bin/$(PROGRAM)$(EXE)

